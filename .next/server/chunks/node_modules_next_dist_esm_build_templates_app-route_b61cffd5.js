module.exports=[2429,e=>{"use strict";var t=e.i(47909),a=e.i(74017),n=e.i(96250),s=e.i(59756),r=e.i(61916),i=e.i(14444),o=e.i(37092),l=e.i(69741),u=e.i(16795),c=e.i(87718),d=e.i(95169),p=e.i(47587),h=e.i(66012),g=e.i(70101),m=e.i(26937),f=e.i(10372),v=e.i(93695);e.i(52474);var b=e.i(5232),R=e.i(89171),w=e.i(60216);async function y(e){try{let{url:t,fullSite:a=!1}=await e.json();if(!t)return R.NextResponse.json({error:"URL is required"},{status:400});if(!/^https?:\/\/.+/.test(t))return R.NextResponse.json({error:"Invalid URL format. Please include http:// or https://"},{status:400});let n=await x(t,a);return await w.prisma.event.create({data:{event:"website_audit",category:"audit",label:t,value:n.overallScore,metadata:n}}),R.NextResponse.json({success:!0,report:n})}catch(e){return console.error("Audit error:",e),R.NextResponse.json({error:"Failed to audit website: "+e.message},{status:500})}}async function x(e,t){let a=await fetch(e,{headers:{"User-Agent":"Mozilla/5.0 (compatible; BIGWEB-Audit/1.0)"}});if(!a.ok)throw Error(`Failed to fetch website: ${a.status} ${a.statusText}`);let n=await a.text();a.headers.get("content-type");let[s,r,i,o,l]=await Promise.all([A(e,n),E(n,e),S(n),C(n),M(n)]),u=Math.round((s.score+r.score+i.score+o.score+l.score)/5);return{url:e,performanceScore:s.score,seoScore:r.score,uiScore:i.score,accessibilityScore:o.score,copyScore:l.score,overallScore:u,performance:s,seo:r,ui:i,accessibility:o,copy:l,timestamp:new Date().toISOString()}}async function A(e,t){let a=[],n=[],s=100;e.startsWith("https://")||(a.push("Site not using HTTPS"),n.push("Enable HTTPS for better security and SEO"),s-=15);let r=(t.match(/<img[^>]+>/g)||[]).filter(e=>{let t=e.match(/src=["']([^"']+)["']/)?.[1];return t&&!t.includes("webp")&&!t.includes("avif")});r.length>0&&(a.push(`${r.length} images not using modern formats (WebP/AVIF)`),n.push("Convert images to WebP or AVIF format for 30-50% size reduction"),s-=Math.min(20,2*r.length));let i=(t.match(/style="/g)||[]).length;i>10&&(a.push(`${i} instances of inline styles found`),n.push("Move inline styles to external CSS files for better performance"),s-=Math.min(10,i));let o=(t.match(/<link[^>]+rel=["']stylesheet["'][^>]*>/g)||[]).length;return o>5&&(a.push(`${o} CSS files may be render-blocking`),n.push("Combine and minify CSS files, use critical CSS inline"),s-=Math.min(15,2*o)),{score:Math.max(0,s),issues:a,recommendations:n}}async function E(e,t){let a=[],n=[],s=100,r=e.match(/<title>([^<]+)<\/title>/);if(r){let e=r[1].length;(e<30||e>60)&&(a.push(`Title tag length (${e}) not optimal`),n.push("Title should be 50-60 characters for best SEO"),s-=5)}else a.push("Missing title tag"),n.push("Add a descriptive title tag (50-60 characters)"),s-=20;e.match(/<meta\s+name=["']description["']\s+content=["']([^"']+)["']/i)||(a.push("Missing meta description"),n.push("Add meta description (150-160 characters)"),s-=15);let i=(e.match(/<h1[^>]*>/g)||[]).length;0===i?(a.push("No H1 heading found"),n.push("Add exactly one H1 heading per page"),s-=15):i>1&&(a.push(`Multiple H1 headings (${i}) found`),n.push("Use only one H1 heading per page"),s-=10);let o=(e.match(/<img[^>]+>/g)||[]).filter(e=>!e.includes("alt="));return o.length>0&&(a.push(`${o.length} images missing alt attributes`),n.push("Add descriptive alt text to all images for accessibility and SEO"),s-=Math.min(20,3*o.length)),e.includes('rel="canonical"')||(a.push("Missing canonical tag"),n.push("Add canonical tag to prevent duplicate content issues"),s-=5),e.includes('property="og:')||(a.push("Missing Open Graph tags"),n.push("Add OG tags for better social media sharing"),s-=10),{score:Math.max(0,s),issues:a,recommendations:n}}async function S(e){let t=[],a=[],n=100;e.includes('name="viewport"')||(t.push("Missing viewport meta tag"),a.push("Add viewport meta tag for mobile responsiveness"),n-=20);let s=e.match(/font-size:\s*([0-9]|1[0-2])px/g)||[];s.length>0&&(t.push(`${s.length} instances of very small fonts (<13px)`),a.push("Use minimum 14px font size for better readability"),n-=Math.min(15,2*s.length)),(e.match(/<button[^>]*>/g)||[]).length+(e.match(/<a\s+[^>]*href=/g)||[]).length<3&&(t.push("Very few interactive elements detected"),a.push("Add clear call-to-action buttons"),n-=10);let r=(e.match(/<form[^>]*>/g)||[]).length;return r>0&&(e.match(/<label[^>]*>/g)||[]).length<r&&(t.push("Forms missing proper labels"),a.push("Add labels to all form inputs for better UX"),n-=15),{score:Math.max(0,n),issues:t,recommendations:a}}async function C(e){let t=[],a=[],n=100;e.match(/<html[^>]+lang=/)||(t.push("Missing lang attribute on html tag"),a.push('Add lang="en" to html tag for screen readers'),n-=10);let s=e.includes("<main"),r=e.includes("<nav");e.includes("<footer"),s||(t.push("Missing <main> landmark"),a.push("Use semantic <main> tag for main content"),n-=10),r||(t.push("Missing <nav> landmark"),a.push("Use semantic <nav> tag for navigation"),n-=5),e.includes("skip")||(t.push("No skip navigation link found"),a.push('Add "skip to main content" link for keyboard users'),n-=10);let i=(e.match(/<button[^>]*>/g)||[]).filter(e=>!e.includes("aria-label")&&!e.includes(">"));i.length>0&&(t.push(`${i.length} buttons without accessible text`),a.push("Add aria-label or visible text to all buttons"),n-=Math.min(15,5*i.length));let o=e.includes("white")||e.includes("#fff"),l=e.includes("white")||e.includes("#fff");return o&&l&&(t.push("Potential color contrast issues detected"),a.push("Ensure 4.5:1 contrast ratio for normal text"),n-=10),{score:Math.max(0,n),issues:t,recommendations:a}}async function M(e){let t=[],a=[],n=100,s=e.replace(/<script[^>]*>.*?<\/script>/gs,"").replace(/<style[^>]*>.*?<\/style>/gs,"").replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim(),r=s.split(" ").filter(e=>e.length>3).length;r<300&&(t.push(`Low word count (${r} words)`),a.push("Add more content (300+ words) for better SEO"),n-=20),/contact|get started|sign up|buy now|learn more|try|demo|free/i.test(s)||(t.push("No clear call-to-action detected"),a.push("Add clear CTAs to guide user actions"),n-=15);let i=r/Math.max(1,s.split(/[.!?]+/).length);return i>25&&(t.push(`Long sentences detected (avg ${Math.round(i)} words)`),a.push("Use shorter sentences (15-20 words) for better readability"),n-=10),/save|improve|increase|reduce|boost|grow|better|fast/i.test(s)||(t.push("Weak value proposition detected"),a.push("Clearly communicate benefits and value"),n-=15),{score:Math.max(0,n),issues:t,recommendations:a}}e.s(["POST",()=>y],26590);var T=e.i(26590);let P=new t.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/audit/route",pathname:"/api/audit",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/audit/route.ts",nextConfigOutput:"",userland:T}),{workAsyncStorage:N,workUnitAsyncStorage:O,serverHooks:k}=P;function U(){return(0,n.patchFetch)({workAsyncStorage:N,workUnitAsyncStorage:O})}async function H(e,t,n){P.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/audit/route";R=R.replace(/\/index$/,"")||"/";let w=await P.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:y,params:x,nextConfig:A,parsedUrl:E,isDraftMode:S,prerenderManifest:C,routerServerContext:M,isOnDemandRevalidate:T,revalidateOnlyGenerated:N,resolvedPathname:O,clientReferenceManifest:k,serverActionsManifest:U}=w,H=(0,l.normalizeAppPath)(R),$=!!(C.dynamicRoutes[H]||C.routes[O]),_=async()=>((null==M?void 0:M.render404)?await M.render404(e,t,E,!1):t.end("This page could not be found"),null);if($&&!S){let e=!!C.routes[O],t=C.dynamicRoutes[H];if(t&&!1===t.fallback&&!e){if(A.experimental.adapterPath)return await _();throw new v.NoFallbackError}}let I=null;!$||P.isDev||S||(I="/index"===(I=O)?"/":I);let q=!0===P.isDev||!$,D=$&&!q;U&&k&&(0,i.setReferenceManifestsSingleton)({page:R,clientReferenceManifest:k,serverActionsManifest:U,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:U})});let F=e.method||"GET",j=(0,r.getTracer)(),L=j.getActiveScopeSpan(),K={params:x,prerenderManifest:C,renderOpts:{experimental:{authInterrupts:!!A.experimental.authInterrupts},cacheComponents:!!A.cacheComponents,supportsDynamicResponse:q,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:A.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,n)=>P.onRequestError(e,t,n,M)},sharedContext:{buildId:y}},B=new u.NodeNextRequest(e),W=new u.NodeNextResponse(t),G=c.NextRequestAdapter.fromNodeNextRequest(B,(0,c.signalFromNodeResponse)(t));try{let i=async e=>P.handle(G,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=j.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=a.get("next.route");if(n){let t=`${F} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${F} ${R}`)}),o=!!(0,s.getRequestMeta)(e,"minimalMode"),l=async s=>{var r,l;let u=async({previousCacheEntry:a})=>{try{if(!o&&T&&N&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let r=await i(s);e.fetchMetrics=K.renderOpts.fetchMetrics;let l=K.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let u=K.renderOpts.collectedTags;if(!$)return await (0,h.sendResponse)(B,W,r,K.renderOpts.pendingWaitUntil),null;{let e=await r.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(r.headers);u&&(t[f.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,n=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:b.CachedRouteKind.APP_ROUTE,status:r.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:n}}}}catch(t){throw(null==a?void 0:a.isStale)&&await P.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:T})},M),t}},c=await P.handleResponse({req:e,nextConfig:A,cacheKey:I,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:C,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:N,responseGenerator:u,waitUntil:n.waitUntil,isMinimalMode:o});if(!$)return null;if((null==c||null==(r=c.value)?void 0:r.kind)!==b.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",T?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),S&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,g.fromNodeOutgoingHttpHeaders)(c.value.headers);return o&&$||d.delete(f.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,m.getCacheControlHeader)(c.cacheControl)),await (0,h.sendResponse)(B,W,new Response(c.value.body,{headers:d,status:c.value.status||200})),null};L?await l(L):await j.withPropagatedContext(e.headers,()=>j.trace(d.BaseServerSpan.handleRequest,{spanName:`${F} ${R}`,kind:r.SpanKind.SERVER,attributes:{"http.method":F,"http.target":e.url}},l))}catch(t){if(t instanceof v.NoFallbackError||await P.onRequestError(e,t,{routerKind:"App Router",routePath:H,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:T})}),$)throw t;return await (0,h.sendResponse)(B,W,new Response(null,{status:500})),null}}e.s(["handler",()=>H,"patchFetch",()=>U,"routeModule",()=>P,"serverHooks",()=>k,"workAsyncStorage",()=>N,"workUnitAsyncStorage",()=>O],2429)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_b61cffd5.js.map